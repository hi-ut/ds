(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{549:function(e,t,r){"use strict";r.r(t);r(51),r(17),r(225),r(69),r(33),r(63),r(185),r(55),r(54);var n=r(14),o=r(21),c=r(35),l=r(40),h=r(37),d=r(26),f=r(12),y=r(105),m=r(82),v=r.n(m);function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(d.a)(e);if(t){var o=Object(d.a)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Object(h.a)(this,r)}}var w=function(e,t,r,desc){var n,o=arguments.length,c=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,r):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(f.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,desc);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(c=(o<3?n(c):o>3?n(t,r,c):n(t,r))||c);return o>3&&c&&Object.defineProperty(t,r,c),c},j=r(587).Network;function O(p){return"https://w3id.org/hi/api/term/property#agential"===p?"":"http://schema.org/spatial"===p?"":"http://schema.org/temporal"===p?"":""}var R=function(e){Object(l.a)(h,e);var t,r=k(h);function h(){var e;return Object(o.a)(this,h),(e=r.apply(this,arguments)).nodes=[],e.edges=[],e.options={nodes:{color:{background:"lightgray",highlight:{background:"lightgray",border:"#FF6E00"}},borderWidthSelected:8,borderWidth:4,shapeProperties:{useBorderWithImage:!0}},edges:{color:"lightgray"},physics:{enabled:!0},layout:{randomSeed:2}},e.otherId="",e}return Object(c.a)(h,[{key:"watchU",value:function(){this.init()}},{key:"created",value:function(){this.init()}},{key:"init",value:function(){this.search()}},{key:"search",value:(t=Object(n.a)(regeneratorRuntime.mark((function e(){var u,t,r,n,o,c,l,h,i,d,s,f,label,y,p,m,k,w,j,R,_;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=this.u,t="\n        PREFIX schema: <http://schema.org/>\n        PREFIX hi: <https://w3id.org/hi/api/term/property#>\n        PREFIX jps: <https://jpsearch.go.jp/term/property#>\n        PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n        SELECT DISTINCT ?p ?s ?image ?label ?keyword ?label_k count(?cho) as ?count ?image_k WHERE { \n          BIND(<".concat(u,"> as ?s)\n          ?cho ?p2 ?s . \n          ?s rdfs:label ?label . \n          optional { ?s schema:image ?image . }\n          ?cho ?p ?keyword . \n          filter (?p != rdf:type && ?p != jps:agential \n          && ?p != schema:license && ?p != jps:relationType && ?p != jps:spatial)\n          filter(?s != ?keyword)\n          ?keyword rdfs:label ?label_k . \n          optional { ?keyword schema:image ?image_k . }\n        } order by desc(?count) limit 20\n      "),e.next=4,v.a.get("https://diyhistory.org/c.php/http://3.212.248.73:8890/sparql?query="+encodeURIComponent(t)+"&output=json");case 4:r=e.sent,n=r.data.results.bindings,o=[],c=[],l={},h=this.entity,i=0;case 11:if(!(i<n.length)){e.next=29;break}if(d=n[i],s=d.s.value,l[s]||(f={label:d.label.value,id:Object.keys(l).length,uri:s,p:"agential"===h?"https://w3id.org/hi/api/term/property#agential":"http://schema.org/"+h,color:"lightgreen"},d.image?(f.shape="image",f.image=d.image.value,f.borderWidth=4,f.color={border:"lightgreen"}):(f.shape="icon",f.icon={code:O(f.p),color:"gray"}),l[s]=f),label=d.label.value,label=d.name?d.name.value:label,"不明"!==(y=d.label_k.value)){e.next=20;break}return e.abrupt("continue",26);case 20:for(p=d.p.value,m=["creator","publisher","contributor","provider"],k=0;k<m.length;k++)p=p.replace("http://schema.org/"+m[k],"http://schema.org/agential");w=d.keyword.value,l[w]||(j={label:y,id:Object.keys(l).length,uri:w,p:p,color:"lightgreen"},d.image_k?(j.shape="image",j.image=d.image_k.value,j.borderWidth=4,j.color={border:"lightgreen"}):(j.shape="icon",j.icon={code:O(p),color:"gray"}),l[w]=j),c.push({from:l[s].id,to:l[w].id,value:d.count.value,title:d.p.value+"（"+Number(d.count.value).toLocaleString()+"）",color:"lightgrey"});case 26:i++,e.next=11;break;case 29:for(R in l)_=l[R],o.push(_);this.nodes=o,this.edges=c;case 32:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"aaa",value:function(e){var t=e.nodes;if(t.length>0){var r=this.nodes[t[0]],n="agential";"http://schema.org/spatial"===r.p?n="spatial":"http://schema.org/about"===r.p?n="about":"http://schema.org/temporal"===r.p&&(n="temporal");var dd=r.uri.split("/"),o=dd[dd.length-1];this.$router.push(this.localePath({name:"entity-entity-id",params:{entity:n,id:o}}),(function(){}),(function(){}))}}},{key:"select",value:function(e){this.otherId="",e!==this.$route.params.id&&(this.otherId=e);var t=this.$refs.network;t.selectNodes([e]),t.focus(e)}},{key:"stabilized",value:function(){this.options.physics.enabled=!1}}]),h}(y.Vue);w([Object(y.Prop)()],R.prototype,"u",void 0),w([Object(y.Prop)()],R.prototype,"entity",void 0),w([Object(y.Watch)("u")],R.prototype,"watchU",null);var _=R=w([Object(y.Component)({components:{network:j}})],R),I=r(87),P=r(106),x=r.n(P),E=r(214),C=r(502),component=Object(I.a)(_,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.nodes.length>0?r("v-container",[r("h2",{staticClass:"my-5 text-center"},[e._v(e._s(e.$t("network")))]),e._v(" "),r("p",{staticClass:"text-center"},[e._v("\n    "+e._s(e.$t("ノードをダブルクリックすることで、当該事物のページに遷移します。"))+"\n  ")]),e._v(" "),r("v-card",{attrs:{"no-body":"",outlined:"",flat:""}},[r("network",{ref:"network",staticStyle:{height:"600px","background-color":"#f0f4c3"},attrs:{nodes:e.nodes,edges:e.edges,options:e.options},on:{"double-click":e.aaa,stabilized:e.stabilized}})],1)],1):e._e()}),[],!1,null,null,null);t.default=component.exports;x()(component,{Network:r(549).default}),x()(component,{VCard:E.a,VContainer:C.a})}}]);